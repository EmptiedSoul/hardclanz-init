#!/bin/bash

[[ "$UID" == 0 ]] || \
	{ echo "hrdrc: must be superuser"; exit 1; }

mountpoint /run &>/dev/null || {
	mount /run
}
mkdir /run/service &>/dev/null
case $1 in
	S)
		cd /etc/rc.d
		echo 
		echo -e "\t\e[1;32mhardclanz-init\e[0m \e[1mis booting\e[0m \e[1;34m$(cat /etc/hostname)\e[0m"
		echo
		make -s $1 -j || /sbin/sulogin
		[[ -n $init_stop ]] && /bin/bash
		;;
	[1-5])
		cd /etc/rc.d
		make -s $1 -j || /sbin/sulogin
		;;
	0)
		cd /etc/rc.d
		{ make -s 0 -j && make -s halt; } || /sbin/sulogin
		;;
	6)
		cd /etc/rc.d
		{ make -s 6 -j && make -s reboot; } || /sbin/sulogin
		;;
	*)
		echo "hrdrc: Usage: hrdrc [0-6]"
		exit 1
		;;
esac
exit
